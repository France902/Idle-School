<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,  user-scalable=no,">
    <title>Idle School</title>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Comic+Neue&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Gloria+Hallelujah&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Patrick+Hand&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Indie+Flower&display=swap');

        body {
            margin: 0;
            padding: 0;
            width: 100vw;
            height: 100vh;
            overflow: hidden;
            background-color: rgb(186, 240, 254);
            user-select: none;
            pointer-events: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            pointer-events: none;
        }

        h1 {
            position: fixed;
            color: white;
            font-family: Arial, sans-serif;
            font-size: 1.2vw;
            text-align: center;

        }

       
        img {
        image-rendering: crisp-edges; 
        }

        #world {
        transform: scale(0.07);
        transform-origin: center center;
        width: 100%;
        height: 100%;
        display: flex;
        justify-content: flex-end;
        align-items: flex-start;
        margin-left: -5vw;
        margin-top: 5vh;
        will-change: transform;
        }

        #piattaforma_1 {
            width: 10vw;
            height: 12vh;
            position: fixed;
            background-color: rgb(168, 108, 3);
            transition: left 0.3s ease-in-out, top 0.3s ease-in-out;
            z-index: -1;
        }

        #piattaforma_2 {
            width: 23.44vw;        
            height: 33.33vh;      
            position: fixed;
            background-color: rgb(124, 3, 168);
            margin-top: 28.5vh;    
            margin-left: 39.65vw;  
            display: none; 
            z-index: -1;
        }

        #preside_container {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-110%, -120%);
            display: flex;
            align-items: center;
            justify-content: center;
            width: 10vw;
            height: 10vw;
            border-radius: 1vw;
        }

        #piattaforme_container {
            position: fixed;
            transform: translate(-510%, 250%);
            display: flex;
            align-items: center;
            justify-content: center;
            width: 10vw;
            height: 10vw;
            border-radius: 1vw;
        }

        #preside {
            width: 30vw;
            height: 30vh;
            position: fixed;
            top: 0vh;
            left: 0vw;
            transition: left 0.1s, top 0.1s;
        }

        #cattedra {
            width: 7.81vw;         
            height: 4.17vh;        
            background-color: rgb(255, 0, 0);
            position: fixed;
            transform: rotate(90deg);
        }

        #studente {
            width: 3.3vw;          
            height: 5vh;       
            background-color: red;
            position: fixed;
            top: 39vh;   
            left: 72.7vw;
            transition: left 0.3s ease-in-out, top 0.3s ease-in-out;
        }

        #entrata_scuola {
            width: 51vw; 
            height: 100vh; 
            position: fixed;
            z-index: -3; 
            transform: scale(2); 
            transition: left 0.3s ease-in-out, top 0.3s ease-in-out;
        }

        #progressCircle {
            position: fixed; 
            top: -13.5vh; 
            left: 26.23vw; 
            background: transparent; 
            display: none; 
            width: 15vw; 
            height: 15vh;
        }
        #missioni {
            position: fixed; 
            left: 80vw; 
            top: 14vh; 
            width: 17vw;
        }
        #immagine_preside_dialoghi {
            position: fixed;
            z-index: -1;
            height: 120vh;
            top: -30vh;
            margin-left: -45vw;
            object-fit: cover;
            pointer-events: none;
            transform: scale(0.8); 
            transform-origin: center center;
            transition: all 0.3s ease-in-out;
        }
        #personaggio_anonimo_dialoghi {
            position: fixed;
            z-index: -1;
            height: 80vh;
            top: 5vh;
            margin-left: 60vw;
            object-fit: cover;
            pointer-events: none; 
            transform: scale(0.8); 
            transform-origin: center center;
            transition: all 0.3s ease-in-out;
        }

        #container-dialogo {
            position: fixed;
            top: 0;
            left: 4.7vw;
            width: 100vw;
            height: 90vh;
            display: flex;
            justify-content: center;
            align-items: end;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
        }

        #dialogo {
            background-color: rgba(255, 255, 255);
            border-radius: 1.5vw;
            padding-left: 2vw;
            padding-right: 2vw;
            margin: 0;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            width: 80vw;
            height: 33vh;
            font-size: 2.2vw;
            color: black;
            text-align: left;
            font-family: "Comic Neue", cursive;
            font-weight: 400;
            position: fixed;
            z-index: 0;
        }

        #dialogo-testo {
            margin: 0;
            padding: 0;
            white-space: pre-wrap; 
            word-wrap: break-word; 
            overflow-wrap: break-word; 
            margin-top: 7.5vh;
            margin-left: 1.5vw;
        }

        #nome-personaggio {
            margin: 0;
            padding: 0;
            white-space: pre-wrap; 
            word-wrap: break-word; 
            overflow-wrap: break-word; 
            margin-top: 1.8vh;
        }

        #box-nome{
            background-color: rgba(255, 255, 255);
            border-radius: 0.5vw;
            padding-left: 0.5vw;
            padding-right: 0.5vw;
            margin: 0;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.4);
            width: 14vw;
            height: 7vh;
            top: 54vh;
            font-size: 1.5vw;
            margin-left: 5vw;
            color: black;
            text-align: center;
            font-family: "Comic Neue", cursive;
            font-weight: 800;
            position: fixed;
            z-index: 1;
        }

        .banco {
            width: 5.21vw;         
            height: 4.17vh;       
            background-color: brown;
            position: fixed;
            transform: rotate(90deg);
        }

        .blocco_pulizia {
            height: 8.33vh;        
            width: 3.13vw;         
            position: fixed;
            background-color: red;
            animation: fadeOpacity 1s infinite alternate;
        }

        .hud-container {
            position: fixed;
            top: 1.5vh;
            right: 1vw;
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 1vh;
            z-index: 5;
        }

        .hud-box {
            background-color: rgba(0, 0, 0, 0.6); 
            color: white;
            font-family: Arial, sans-serif;
            font-size: 1.2vw;
            padding: 0.6vh 1vw;
            border: 0.15vw solid white;
            border-radius: 0.6vw;
            min-width: 8vw;
            text-align: right;
        }

        .hud_missioni {
            position: absolute;
            top: 14.5vh;
            right: 5vw;
            width: 17vw;
            background-color: rgba(50, 50, 50, 0.6);
            opacity: 1;
            border: 0.15vw solid white;
            border-radius: 0.6vw;
            padding: 0.6vh 0 0.6vh 1vw; 
            color: white;
            box-shadow: 0 0.4vw 0.8vw rgba(0, 0, 0, 0.3);
            overflow: hidden;
            transition: max-height 0.3s ease-in-out;
            pointer-events: auto;
        }

        .toggle-icon {
            position: absolute;
            top: 0.6vh;
            right: 0.4vw;
            width: 2vw;
            height: 3vh;
            opacity: 1;
            transition: opacity 0.3s ease-in-out;
        }

        .missione_1, .missione_2, .missione_3 {
            display: flex;
            align-items: center;
            width: 100%;
            margin: 3.3vh 0;
            cursor: pointer;
        }

        .missione_1 h1, .missione_2 h1, .missione_3 h1 {
            font-size: 1.7vw;
            margin: 0;
            padding-left: 4vw;
            word-break: break-word;
            white-space: normal;
        }

        .missione_1 img, .missione_2 img, .missione_3 img {
            width: 3vw;
            height: 5vh;
        }

        .missione_2, .missione_3 {
            opacity: 0;
            transition: opacity 0.4s ease-in-out;
            
        }

        .hud_missioni.open .missione_1, .hud_missioni.open .missione_2, .hud_missioni.open .missione_3 {
            opacity: 1;
            cursor: auto;
        }

        .hud_missioni.closed .missione_1 {
            cursor: pointer;
        }

        .hud_missioni.closed {
            max-height: 10vh;
            cursor: pointer;
        }

        .hud_missioni.open {
            max-height: 30vh;
            cursor: auto;
        }
        .scuola-img {
            width: 100vw;
            height: 130vh;
            position: fixed;
            z-index: 0;
            transform: scale(2);
            transition: left 0.3s ease-in-out, top 0.3s ease-in-out;
            will-change: transform, left, top;
        }

        @keyframes fadeOpacity {
            0% {
                opacity: 1;
            }
            50% {
                opacity: 0.5;
            }
            100% {
                opacity: 1;
            }
        }
    </style>
</head>

<body>
    
    
  <div id="world">
    <div id="Edificio_scolastico" style="z-index: -1;">
      <img class="scuola-img" style="left: 0vw; top: -260vh;" src="map-small.jpg" />
        <img class="scuola-img" style="left: 0vw; top: 0vh;" src="map-small.jpg" />
        <img class="scuola-img" style="left: 200vw; top: -260vh;" src="map-small.jpg" />
        <img class="scuola-img" style="left: 200vw; top: 0vh;" src="map-small.jpg" />
        
        <img class="scuola-img" style="left: -200vw; top: 0vh;" src="map-small.jpg" />
        <img class="scuola-img" style="left: -200vw; top: -260vh;" src="map-small.jpg" />
        <img class="scuola-img" style="left: -200vw; top: -520vh;" src="map-small.jpg" />
        <img class="scuola-img" style="left: 0vw; top: -520vh;" src="map-small.jpg" />
        
        <img class="scuola-img" style="left: 200vw; top: -520vh;" src="map-small.jpg" />
        <img class="scuola-img" style="left: 400vw; top: -520vh;" src="map-small.jpg" />
        <img class="scuola-img" style="left: 400vw; top: -260vh;" src="map-small.jpg" />
        <img class="scuola-img" style="left: 400vw; top: 0vh;" src="map-small.jpg" />
        
        <img class="scuola-img" style="left: 0vw; top: 200vh; height: 90vh;" src="map-small.jpg" />
        <img class="scuola-img" style="left: 200vw; top: 200vh; height: 90vh;" src="map-small.jpg" />
        <img class="scuola-img" style="left: -200vw; top: 200vh; height: 90vh;" src="map-small.jpg" />
        <img class="scuola-img" style="left: 400vw; top: 200vh; height: 90vh;" src="map-small.jpg" />

        <div id="piattaforme_container">
            <img class="scuola-img" src="a_rock.jpg" style="position: fixed; left: 40vw; top: -30vh; width: 8.5vw; height: 13vh; z-index: 0;">
        </div>
    </div>
    
    <div id="preside_container">
        <img src="Preside.png" id="preside">
    </div>

    <div id="container-dialogo">
        <div id="box-nome">
            <p id="nome-personaggio">nome personaggio</p>
        </div>
        <div id="dialogo">
            <p id="dialogo-testo">Prova-dialogo</p>
        </div>
        <img src="Preside.png" alt="" id="immagine_preside_dialoghi">

        <img src="Personaggio_anonimo.png" alt="" id="personaggio_anonimo_dialoghi">
    </div>

    </div>
    
    <div class="hud-container">
        <div id="soldi" class="hud-box">0‚Ç¨</div>
        <!--
        <div id="classi" class="hud-box">0 üè´</div>
        <div id="missioni" class="hud_missioni closed" >
        <img class="toggle-icon" src="icona_menu_missioni.png" alt="Icona Toggle" onclick="menu_missioni()">
        <div class="missione_1" onclick="toggleMenu()">
            <img src="icona_punto_interrogativo.png" alt="Icona Missione 1">
            <h1>missione 1</h1>
        </div>
        <div class="missione_2" onclick="toggleMenu()">
            <img src="icona_punto_interrogativo.png" alt="Icona Missione 2">
            <h1>missione 2</h1>
        </div>
        <div class="missione_3" onclick="toggleMenu()">
            <img src="icona_punto_interrogativo.png" alt="Icona Missione 3">
            <h1>missione 3</h1>
        </div>
    </div>

    <div id="cartello-orizzontale" class="scuola-img" style="position: fixed; width: 20vw; height: 7.87vh; left: 93vw; top: -10.33vh; z-index: 2; display: flex; align-items: center; justify-content: center; font-family: Arial, sans-serif; font-size: 1vw; color: #333; transition: left 0.3s ease-in-out, top 0.3s ease-in-out;">
        <p id="testo_cartello" style="font-size: 1.8vw; font-family: 'Gloria Hallelujah', cursive; white-space: nowrap; overflow: visible;">A new school is opening!</p>
    </div>


    <div id="piattaforma_2">
        <div class="banco" id="banco1" style="margin-top: 4.17vh; margin-left: 14.58vw;"><p>Banco1</p></div>
        <div class="banco" id="banco2" style="margin-top: 20.83vh; margin-left: 14.58vw;"><p>Banco2</p></div>
        <div id="cattedra" style="margin-top: 12.5vh; margin-left: 1.56vw;"><p>Cattedra</p></div>
    </div>

    <div id="blocco_pulizia_1" class="blocco_pulizia" style="margin-left: 58.23vw; margin-top: 31vh; display: none;"></div>

    <div id="blocco_pulizia_2" class="blocco_pulizia" style="margin-left: 58.23vw; margin-top: 47vh; display: none;"></div>

        -->
    </div>

        



    <script>
        const canvas = document.getElementById('progressCircle');
        const piattaforma_1 = document.getElementById('piattaforma_1');
        const piattaforma_2 = document.getElementById('piattaforma_2');
        const studente = document.querySelector('.studente');
        const unlockedText = document.getElementById('unlocked');
        const banco1 = document.getElementById('banco1');
        const banco2 = document.getElementById('banco2')
        const toggle_icon = document.querySelector('.toggle-icon');

        let soldi = 0;
        let classi = 0;
        let fila_studenti = 10;
        let condizione_click = false;

   
        let students = document.createElement('div');
        students.id = 'students-container';
        document.body.appendChild(students);

        function createStudents() {
            let cont = 39;
            for (let i = 0; i < fila_studenti; i++) {
                const newStudent = document.createElement('div');
                newStudent.id = 'studente';
                newStudent.style.left = '72.7vw';
                newStudent.className = 'scuola-img';
                newStudent.style.top = cont + "vh";
                cont += 8;
                students.appendChild(newStudent);
            }
        }
        
        // createStudents();

    /* const ctx = canvas.getContext('2d');
    
    let progress = 0;
    const radius = 30;
    const centerX = canvas.width / 2;
    const centerY = canvas.height / 2;

    
    canvas.style.marginLeft = '17.5vw'; 
    canvas.style.marginTop = '42.17vh';
    
    let animationId = null;
    let condizione_posizione = true;
    let cond_start = false, cond_stanza1 = false, cond_stanza2 = false;
    let settime = null;
    
    function drawCircle(progress) {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        // Draw base circle
        ctx.beginPath();
        ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);
        ctx.strokeStyle = '#bbb';
        ctx.lineWidth = 11;
        ctx.stroke();

        // Draw progress arc
        ctx.beginPath();
        ctx.arc(centerX, centerY, radius, -Math.PI/2, -Math.PI/2 + 2 * Math.PI * progress, false);
        ctx.strokeStyle = '#228B22';
        ctx.lineWidth = 8;
        ctx.stroke();
    }

    function animate() {
        condizione_posizione = true;
        if (progress < 1 ) {
            progress += 0.0042;
            drawCircle(progress);
            animationId = requestAnimationFrame(animate);
        }
    }

    function stopAnimation() {
        progress = 0;
        clearTimeout(settime);
        condizione_posizione = false;
        cond_stanza1 = false;
        canvas.style.display = 'none';
        piattaforma_1.style.border = 'none';
        cancelAnimationFrame(animationId);
        animationId = null;
}
        */

        const dialogo = document.getElementById('dialogo');
        const dialogoTesto = document.getElementById('dialogo-testo');
        const container_dialogo = document.getElementById('container-dialogo');
        const immaginePreside = document.getElementById('immagine_preside_dialoghi');
        const personaggioAnonimo = document.getElementById('personaggio_anonimo_dialoghi');

        let cond_testo = true;
        let cond_skip = true;
        let cond_dialogo1 = false;

        function mostraTestoAnimato(testo, velocita = 15) {
            dialogoTesto.textContent = "";
            cond_skip = true;
            let i = 0;
            let scriviLettera = function() {
                if (!cond_testo) {
                    dialogoTesto.textContent = testo;
                    cond_testo = true; 
                    return;
                }
                if (i < testo.length) {
                    dialogoTesto.textContent += testo[i];
                    i++;
                    setTimeout(scriviLettera, velocita);
                }
                else{
                    cond_skip = false;
                    window.removeEventListener('keydown', arguments.callee);
                    window.removeEventListener('mousedown', arguments.callee);
                }
            }
            scriviLettera();
        }
        function cambiaNome(nome) {
            const nomePersonaggio = document.getElementById('nome-personaggio');
            nomePersonaggio.textContent = nome;
        }
        function cambiaboxNome(posizione) {
            const boxNome = document.getElementById('box-nome');
            if(posizione == 1) {
                boxNome.style.left = "11vw";
                immaginePreside.style.transform = "scale(0.9)";
                personaggioAnonimo.style.opacity = "0.8";
                immaginePreside.style.opacity = "1";
                personaggioAnonimo.style.transform = "scale(0.8)";
            }
            else {
                boxNome.style.left = "73vw";
                immaginePreside.style.transform = "scale(0.8)";
                personaggioAnonimo.style.opacity = "1";
                immaginePreside.style.opacity = "0.8";
                personaggioAnonimo.style.transform = "scale(0.9)";
            }
        }

        mostraTestoAnimato("Prova dialogo animato");
        cambiaNome("nome preside");
        cambiaboxNome(1);
        

        const righe = [
            [
            "secondo dialogo",
            "Urso",
            2
            ],
            [
            "terzo dialogo",
            "nome preside",
            1
            ],
            [
            "quarto dialogo",
            "Urso",
            2
            ],
            [
            "quinto dialogo",
            "nome preside",
            1
            ]
        ];
        let indexRiga = 0;

        function mostraProssimaRiga() {
            if (indexRiga < righe.length) {
                mostraTestoAnimato(righe[indexRiga][0]);
                cambiaNome(righe[indexRiga][1]);
                cambiaboxNome(righe[indexRiga][2]);
                indexRiga++;
            } else {
                
            }
        }




        function controllo_skip() {
            window.addEventListener('keydown', function(event) {
            if (event.key === 'Enter' && cond_skip && cond_dialogo1) {
                cond_skip = false;
                cond_testo = false; 
            }
            else{
                if(event.key === 'Enter' && cond_dialogo1) {
                    mostraProssimaRiga();
                }
            }
            });

            window.addEventListener('mousedown', function(event) {
                if (event.button === 0 && cond_skip && cond_dialogo1) { 
                    cond_skip = false;
                    cond_testo = false;
                }
                else{
                if(event.button === 0 && cond_dialogo1) {
                    mostraProssimaRiga();
                }
            }
            });
            
        }
    const preside = document.getElementById('preside');
    const scuolaImgs = document.querySelectorAll('.scuola-img');
    let posX = 0;
    let posY = 0;

    preside.style.top = posY + 'vh';
    preside.style.left = posX + 'vw';

            function handleKeydown(event) {

            if (event.key === 'd') {
                preside.style.transition = "top 0.06s ease-in-out, left 0.06s ease-in-out";
                preside.style.transform = "scaleX(1)";
                preside.src = "Preside.png";
                preside.style.top = (parseFloat(preside.style.top)) + 'vh';
                posX += 3;
                scuolaImgs.forEach(img => {
                    img.style.left = (parseFloat(img.style.left) - 3) + 'vw';
                });
                
                setTimeout(() => {
                    preside.style.top = (parseFloat(preside.style.top) - 0.8) + 'vh';
                }, 60);
                setTimeout(() => {
                    preside.style.top = (parseFloat(preside.style.top) - 0.8) + 'vh';
                }, 120);
                setTimeout(() => {
                    preside.style.top = (parseFloat(preside.style.top)) + 'vh';
                }, 180);
                setTimeout(() => {
                    preside.style.top = (parseFloat(preside.style.top) + 0.8) + 'vh';
                }, 240);
                setTimeout(() => {
                    preside.style.top = (parseFloat(preside.style.top) + 0.8) + 'vh';
                }, 300);
                window.removeEventListener('keydown', handleKeydown);

                setTimeout(() => {
                    window.addEventListener('keydown', handleKeydown);
                }, 250);  
            }
            if (event.key === 'a') {
                preside.style.transition = "top 0.06s ease-in-out, left 0.06s ease-in-out";
                preside.style.transform = "scaleX(-1)";
                preside.src = " Preside.png";
                posX -= 3;
                preside.style.top = (parseFloat(preside.style.top)) + 'vh';
                scuolaImgs.forEach(img => {
                    img.style.left = (parseFloat(img.style.left) + 3) + 'vw';
                });
                setTimeout(() => {
                    preside.style.top = (parseFloat(preside.style.top) - 0.8) + 'vh';
                }, 60);
                setTimeout(() => {
                    preside.style.top = (parseFloat(preside.style.top) - 0.8) + 'vh';
                }, 120);
                setTimeout(() => {
                    preside.style.top = (parseFloat(preside.style.top)) + 'vh';
                }, 180);
                setTimeout(() => {
                    preside.style.top = (parseFloat(preside.style.top) + 0.8) + 'vh';
                }, 240);
                setTimeout(() => {
                    preside.style.top = (parseFloat(preside.style.top) + 0.8) + 'vh';
                }, 300);
                window.removeEventListener('keydown', handleKeydown);
                setTimeout(() => {
                    window.addEventListener('keydown', handleKeydown);
                }, 250);  
            }
            if (event.key === 's') {
                preside.src = "Preside_davanti.png";
                preside.style.transition = "top 0.1s ease-in-out, left 0.1s ease-in-out";
                posY += 5;
                    preside.style.top = (parseFloat(preside.style.top)) + 'vh';
                    scuolaImgs.forEach(img => {
                        img.style.top = (parseFloat(img.style.top) - 5) + 'vh';
                    });
                    setTimeout(() => {
                    preside.style.top = (parseFloat(preside.style.top) + 3) + 'vh';
                    }, 40);
                    setTimeout(() => {
                        preside.style.top = (parseFloat(preside.style.top) + 2) + 'vh';
                    }, 100);
                    setTimeout(() => {
                        preside.style.top = (parseFloat(preside.style.top) - 2) + 'vh';
                    }, 225);
                    setTimeout(() => {
                        preside.style.top = (parseFloat(preside.style.top) -  3) + 'vh';
                    }, 300);
                    window.removeEventListener('keydown', handleKeydown);
                    setTimeout(() => {
                            window.addEventListener('keydown', handleKeydown);
                    }, 280);
            }
            if (event.key === 'w') {
                preside.src = "Preside_dietro.png";
                preside.style.transition = "top 0.1s ease-in-out, left 0.1s ease-in-out";
                preside.style.top = (parseFloat(preside.style.top)) + 'vh';
                posY -= 5;
                scuolaImgs.forEach(img => {
                    img.style.top = (parseFloat(img.style.top) + 5) + 'vh';
                });                
                setTimeout(() => {
                preside.style.top = (parseFloat(preside.style.top) - 3) + 'vh';
                }, 40);
                setTimeout(() => {
                    preside.style.top = (parseFloat(preside.style.top) - 2) + 'vh';
                }, 100);
                setTimeout(() => {
                    preside.style.top = (parseFloat(preside.style.top) + 2) + 'vh';
                }, 225);
                setTimeout(() => {
                    preside.style.top = (parseFloat(preside.style.top) +  3) + 'vh';
                }, 300);
                window.removeEventListener('keydown', handleKeydown);
                setTimeout(() => {
                    window.addEventListener('keydown', handleKeydown);
                }, 280);
            }
            control_position(posX, posY);
        }
        window.addEventListener('keydown', handleKeydown);
const world = document.getElementById('world');
 function scala() {
    let scale = 0.07;
    let speed = 0.006; 
    function animate(){
        scale += speed;
        if (scale >= 1) {
            scale = 1;
            world.style.transform = `scale(1)`;
        } else {
            world.style.transform = `scale(${scale})`;
            requestAnimationFrame(animate);
        }
    }
    requestAnimationFrame(animate);
}
controllo_skip();
     // setTimeout(scala, 1000);
        let cond = false;
        let cond_piattaforma_1 = false;

        function control_position(posX, posY) {
            if (posX >= 33 && posX <= 48 && posY >= -45 && posY <= -20 && cond_piattaforma_1 == false){
                condizione_posizione = true;
                settime = setTimeout(() => {
                    if(condizione_posizione) {
                    cond_piattaforma_1 = true;
                    container_dialogo.style.opacity = '1';
                    cond_dialogo1 = true;
                }
                }, 2000);
            } else {
                clearTimeout(settime);
                condizione_posizione = false;
                cond_piattaforma_1 = false;
            }  
        }
        let pos_student = 0;
        function farming_1() {
            let ricavo = 10;
            let entra = true;
            let entra2 = true;
            let pos1 = 0;
            let pos2 = 1;
           
            interval1(entra, pos1, ricavo);
            
            setTimeout(() => {
                interval2(entra2, pos2, ricavo);  
            }, 2000);
        }
        function animazione_studente_entrata_1(pos) {
            let studente = students.children[pos];
            let posY = parseInt(studente.style.marginTop);
            studente.style.transition = 'margin-top 0.5s ease-in-out, margin-left 0.7s ease-in-out';
            studente.style.marginTop = '62.83vh'; 
            setTimeout(() => {
                studente.style.marginLeft = (parseFloat(banco1.style.marginLeft) + 44) + 'vw'; 
            }, 500);

            setTimeout(() => {
                studente.style.transition = 'margin-top 1.5s ease-in-out';
                studente.style.marginTop = (parseFloat(banco1.style.marginTop) + 28) + 'vh'; 
            }, 1200);
        }
        function animazione_studente_entrata2(pos){
            let studente = students.children[pos];
            let posY = parseInt(studente.style.marginTop);
            studente.style.transition = 'margin-top 0.5s ease-in-out, margin-left 0.7s ease-in-out';
            studente.style.marginTop = '62.83vh';
            setTimeout(() => {
                studente.style.marginLeft = (parseFloat(banco2.style.marginLeft) + 44) + 'vw';
            }, 500);

            setTimeout(() => {
                studente.style.transition = 'margin-top 1s ease-in-out';
                studente.style.marginTop = (parseFloat(banco2.style.marginTop) + 28) + 'vh';
            }, 1200);
        }

        function animazione_studente_uscita_1(pos) {
            let studente = students.children[pos];
            let posY = parseInt(studente.style.marginTop);
            studente.style.transition = 'margin-top 1s ease-in-out, margin-left 1s ease-in-out';
            studente.style.marginTop = '4.17vh';
            setTimeout(() => {
                studente.style.marginLeft = '15.63vw'; 
            }, 1000);

            setTimeout(() => {
                studente.style.transition = 'margin-top 1.5s ease-in-out, margin-left 1s ease-in-out';
                studente.style.marginTop = '103.33vh'; 
            }, 2000);
        }
        function animazione_studente_uscita_2(pos) {
            let studente = students.children[pos];
            let posY = parseInt(studente.style.marginTop);
            studente.style.transition = 'margin-top 1s ease-in-out, margin-left 1s ease-in-out';
            studente.style.marginTop = '4.17vh';
            setTimeout(() => {
                studente.style.transition = 'margin-top 1.5s ease-in-out, margin-left 1s ease-in-out';
                studente.style.marginLeft = '15.63vw';
            }, 1000);

            setTimeout(() => {
                studente.style.transition = 'margin-top 1.5s ease-in-out, margin-left 1s ease-in-out';
                studente.style.marginTop = '103.33vh';
            }, 2000);
        }
        function interval1(entra, pos1, ricavo) {
               setTimeout(() => {
                    const newStudent = document.createElement('div');
                    newStudent.id = 'studente';
                    newStudent.style.marginTop = '100vh';
                    students.appendChild(newStudent);  
                    for (let i = pos1+1; i < students.children.length; i++) {
                        let stud = students.children[i];
                        let currentTop = parseFloat(stud.style.marginTop);
                        stud.style.transition = 'margin-top 0.5s ease-in-out';
                        if(i==students.children.length-1){
                            setTimeout(() => {
                                stud.style.marginTop = (currentTop - 4.58) + 'vh';
                            }, 50);
                        }
                        else{
                            stud.style.marginTop = (currentTop - 4.58) + 'vh';
                            }
                    }
                    }, 1000);
                    entra=true;
                animazione_studente_entrata_1(pos_student);
                pos1 = pos_student;
                pos_student += 1;
                let Interval_1 = setInterval(() => {

            
                if(entra == true){
                    soldi += ricavo;
                    entra = false;
                    document.getElementById('blocco_pulizia_1').style.display = 'block';
                    animazione_studente_uscita_1(pos1);

                    clearInterval(Interval_1);
                    controllo_pulizia(entra, pos1, ricavo);
                   
                }
                document.getElementById('soldi').innerText = soldi + "‚Ç¨";
            }, 5000);
            }
        function controllo_pulizia(entra, pos1, ricavo) {
                window.addEventListener('keydown', function(event) {
                if(parseInt(preside.style.left) == 59 && parseInt(preside.style.top) >= 24 && parseInt(preside.style.top) <= 36 && (event.key == 'c' || event.key == 'C')) {
                    if(condizione_click == false){
                    removeEventListener('keydown', arguments.callee);
                    condizione_click = true;
                    setTimeout(() => {
                        condizione_click = false;
                    }, 1000);
                    setTimeout(() => { document.body.style.pointerEvents = ""; }, 5000);
                    
                    document.getElementById('blocco_pulizia_1').style.display = 'none';
                    interval1(entra, pos1, ricavo);
                } 
            }
            });
            }
        function interval2(entra2, pos2, ricavo) {
            setTimeout(() => {
                    const newStudent = document.createElement('div');
                    newStudent.id = 'studente';
                    newStudent.style.marginTop = '100vh';
                    students.appendChild(newStudent);
                    for (let i = pos2+1; i < students.children.length; i++) {
                        let stud = students.children[i];
                        let currentTop = parseInt(stud.style.marginTop);
                        stud.style.transition = 'margin-top 0.5s ease-in-out';
                        if(i==students.children.length-1){
                            setTimeout(() => {
                                stud.style.marginTop = (currentTop - 4.58) + 'vh';
                            }, 50);
                        }
                        else{
                            stud.style.marginTop = (currentTop - 4.58) + 'vh';
                        }
                    }
                }, 1000);
                entra2=true;
                animazione_studente_entrata2(pos_student);
                pos2 = pos_student;
                pos_student += 1;
            let Interval_2 = setInterval(() => {
                    
                if(entra2 == true){
                    soldi += ricavo;
                    document.getElementById('soldi').innerText = soldi + "‚Ç¨";
                    entra2 = false;
                    document.getElementById('blocco_pulizia_2').style.display = 'block';
                    animazione_studente_uscita_2(pos2);
                    clearInterval(Interval_2);
                    controllo_pulizia_2(entra2, pos2, ricavo);
                }
                
            }, 5000);
        }
        function controllo_pulizia_2(entra2, pos2, ricavo) {
                window.addEventListener('keydown', function(event) {

                if(parseInt(preside.style.left) == 59 && parseInt(preside.style.top) >= 40 && parseInt(preside.style.top) <= 52 && (event.key == 'c' || event.key == 'C')) {
                    if(condizione_click == false){
                    removeEventListener('keydown', arguments.callee);
                    window.removeEventListener('keydown', arguments.callee);
                    condizione_click = true;
                    setTimeout(() => {
                        condizione_click = false;
                    }, 1000);
                    document.getElementById('blocco_pulizia_2').style.display = 'none';
                    interval2(entra2, pos2, ricavo);
                }
                } 
            });
            }

            function toggleMenu() {
            const menu = document.getElementById('missioni');
            menu.classList.toggle('open');
            menu.classList.toggle('closed');
        }
        
        toggle_icon.addEventListener('mouseenter', function() {
            toggle_icon.style.opacity = '0.7';
        });
        toggle_icon.addEventListener('mouseleave', function() {
            toggle_icon.style.opacity = '1';
        });
    </script>
</body>
</html>
